# Smart Plant Care System - 配置文件

# 环境参数
environment:
  name: "PlantCareEnv-v0"
  timestep_hours: 1  # 每个时间步代表1小时
  episode_days: 30   # 每个episode模拟30天
  
  # 植物物理参数
  plant:
    initial_health: 80.0
    health_min: 0.0
    health_max: 100.0
    optimal_moisture_min: 0.4  # 40%
    optimal_moisture_max: 0.7  # 70%
    optimal_temp_min: 18.0     # °C
    optimal_temp_max: 28.0     # °C
    
  # 土壤参数
  soil:
    capacity: 1.0  # 最大含水量（归一化）
    initial_moisture: 0.5
    evaporation_rate: 0.03  # 基础蒸发率（每小时）
    temp_evap_coeff: 0.002  # 温度对蒸发的影响
    
  # 环境条件
  weather:
    temp_mean: 22.0
    temp_std: 3.0
    temp_day_night_diff: 5.0
    light_max: 1000  # lux
    
  # 动作空间
  actions:
    water_max: 100  # ml
    lamp_power: 500  # watts

# PPO智能体参数
ppo:
  learning_rate: 0.0003
  n_steps: 2048      # 每次更新收集的步数
  batch_size: 64
  n_epochs: 10       # 每次更新的优化轮数
  gamma: 0.99        # 折扣因子
  gae_lambda: 0.95   # GAE参数
  clip_range: 0.2    # PPO裁剪范围
  ent_coef: 0.01     # 熵系数（鼓励探索）
  vf_coef: 0.5       # 价值函数系数
  max_grad_norm: 0.5 # 梯度裁剪
  
  # 网络架构
  policy_network:
    net_arch: [256, 256]  # 两层，每层256神经元
    activation: "tanh"
    
  value_network:
    net_arch: [256, 256]
    activation: "tanh"

# 训练参数
training:
  total_timesteps: 5_000_000  # 总训练步数（GPU下约3小时）
  eval_freq: 10_000           # 每10k步评估一次
  save_freq: 50_000           # 每50k步保存模型
  n_eval_episodes: 10         # 每次评估运行10个episode
  device: "auto"              # "auto" | "cuda" | "cpu"
  seed: 42
  
  # 多场景训练（域随机化）
  domain_randomization:
    enabled: true
    temp_range: [15, 35]      # 温度范围变化
    evap_multiplier: [0.7, 1.3]  # 蒸发率倍数
    sensor_noise_std: 0.05    # 传感器噪声标准差

# 奖励函数权重
reward:
  alpha: 1.0      # 健康度增益权重
  beta: 0.01      # 用水惩罚权重（每ml）
  gamma: 0.001    # 能耗惩罚权重（每watt-hour）
  delta: 0.5      # 约束违规惩罚权重（每小时）
  
  # 约束定义
  constraints:
    moisture_min: 0.2   # 土壤湿度不能低于20%
    moisture_max: 0.9   # 土壤湿度不能高于90%
    temp_min: 15.0      # 温度不能低于15°C
    temp_max: 32.0      # 温度不能高于32°C

# 基线策略参数
baselines:
  fixed_schedule:
    water_times: [8, 20]     # 每天8点和20点浇水
    water_amount: 50         # ml
    lamp_schedule: [6, 22]   # 灯光6点开，22点关
    
  threshold_rule:
    moisture_threshold: 0.3  # 低于30%时浇水
    water_amount: 50
    light_threshold: 200     # 低于200 lux时开灯

# 评估和可视化
evaluation:
  test_scenarios:
    - name: "normal"
      temp_bias: 0
      evap_multiplier: 1.0
    - name: "hot_dry"
      temp_bias: 5
      evap_multiplier: 1.5
    - name: "cloudy"
      temp_bias: -2
      light_multiplier: 0.6
    - name: "sensor_noise"
      noise_std: 0.1
      
  metrics:
    - "avg_health"
    - "final_health"
    - "total_water_used"
    - "total_energy_used"
    - "violation_hours"
    - "efficiency_score"

# 日志和输出
logging:
  tensorboard_log: "./logs/tensorboard/"
  save_path: "./models/"
  video_folder: "./videos/"
  verbose: 1
  
  # 进度报告
  progress_bar: true
  log_interval: 10  # 每10次更新记录一次

# GPU优化
gpu:
  enabled: true
  device_id: 0
  cudnn_benchmark: true
  mixed_precision: false  # 混合精度训练（实验性）

